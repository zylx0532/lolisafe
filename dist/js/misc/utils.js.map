{"version":3,"sources":["utils.js"],"names":["lsKeys","siBytes","page","prepareShareX","const","values","token","albumid","album","filelength","fileLength","age","uploadAge","striptags","stripTags","headers","keys","Object","i","length","push","origin","location","hostname","pathname","replace","originClean","sharexElement","document","querySelector","sharexFile","join","sharexBlob","Blob","type","setAttribute","URL","createObjectURL","getPrettyDate","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getPrettyBytes","num","isFinite","si","localStorage","neg","scale","exponent","Math","min","floor","log","LOG10E","Number","pow","toPrecision","charAt"],"mappings":"AAGAA,OAAOC,QAAU,UAEjBC,KAAKC,cAAa,WAChBC,IAAMC,EAASH,KAAKI,MAAQ,CAC1BA,MAAOJ,KAAKI,OAAS,GACrBC,QAASL,KAAKM,OAAS,IACrB,GACJH,EAAOI,WAAaP,KAAKQ,YAAc,GACvCL,EAAOM,IAAMT,KAAKU,WAAa,GAC/BP,EAAOQ,UAAYX,KAAKY,WAAa,GAIrC,IAFAV,IAAMW,EAAU,GACVC,EAAOC,OAAOD,KAAKX,GAChBa,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAE/BH,EAAQK,KAAK,QAAQJ,EAAKE,GAAE,OAAOb,EAAOW,EAAKE,IAAG,KAEpDd,IAAMiB,GAAUC,SAASC,SAAWD,SAASE,UAAUC,QAAQ,kBAAmB,IAC5EC,EAAcL,EAAOI,QAAQ,MAAO,KAEpCE,EAAgBC,SAASC,cAAc,WACvCC,EAAa,iBACRJ,EAAW,yGAGLJ,SAAS,SAAQ,KAAKD,EAAM,kCAE7CN,EAAQgB,KAAK,OAAM,oJAQbC,EAAa,IAAIC,KAAK,CAACH,GAAa,CAAEI,KAAM,6BAElDP,EAAcQ,aAAa,OAAQC,IAAIC,gBAAgBL,IACvDL,EAAcQ,aAAa,WAAeT,EAAW,UAGvDxB,KAAKoC,cAAa,SAAGC,GACnB,OAAOA,EAAKC,cAAgB,KACzBD,EAAKE,WAAa,EAAI,IAAM,KAC5BF,EAAKE,WAAa,GAAK,KACvBF,EAAKG,UAAY,GAAK,IAAM,IAC7BH,EAAKG,UAAY,KAChBH,EAAKI,WAAa,GAAK,IAAM,IAC9BJ,EAAKI,WAAa,KACjBJ,EAAKK,aAAe,GAAK,IAAM,IAChCL,EAAKK,aAAe,KACnBL,EAAKM,aAAe,GAAK,IAAM,IAChCN,EAAKM,cAGT3C,KAAK4C,eAAc,SAAGC,GAGpB,GAAmB,iBAARA,IAAqBC,SAASD,GAAM,OAAOA,EAEtD3C,IAAM6C,EAAsC,MAAjCC,aAAalD,OAAOC,SACzBkD,EAAMJ,EAAM,EAAI,IAAM,GACtBK,EAAQH,EAAK,IAAO,KAE1B,GADIE,IAAKJ,GAAOA,GACZA,EAAMK,EAAO,MAAO,GAAGD,EAAMJ,EAAG,KAEpC3C,IAAMiD,EAAWC,KAAKC,IAAID,KAAKE,MAAOF,KAAKG,IAAIV,GAAOO,KAAKI,OAAU,GAAI,GAGzE,MAAO,GAAGP,EAFKQ,QAAQZ,EAAMO,KAAKM,IAAIR,EAAOC,IAAWQ,YAAY,IAE9C,MADTZ,EAAK,WAAa,YAAYa,OAAOT,EAAW,IAAMJ,EAAK,GAAK,MAChD","file":"utils.js","sourcesContent":["/* global lsKeys, page */\n\n// keys for localStorage\nlsKeys.siBytes = 'siBytes'\n\npage.prepareShareX = () => {\n  const values = page.token ? {\n    token: page.token || '',\n    albumid: page.album || ''\n  } : {}\n  values.filelength = page.fileLength || ''\n  values.age = page.uploadAge || ''\n  values.striptags = page.stripTags || ''\n\n  const headers = []\n  const keys = Object.keys(values)\n  for (let i = 0; i < keys.length; i++)\n    // Pad by 4 space\n    headers.push(`    \"${keys[i]}\": \"${values[keys[i]]}\"`)\n\n  const origin = (location.hostname + location.pathname).replace(/\\/(dashboard)?$/, '')\n  const originClean = origin.replace(/\\//g, '_')\n\n  const sharexElement = document.querySelector('#ShareX')\n  const sharexFile = `{\n  \"Name\": \"${originClean}\",\n  \"DestinationType\": \"ImageUploader, FileUploader\",\n  \"RequestMethod\": \"POST\",\n  \"RequestURL\": \"${location.protocol}//${origin}/api/upload\",\n  \"Headers\": {\n${headers.join(',\\n')}\n  },\n  \"Body\": \"MultipartFormData\",\n  \"FileFormName\": \"files[]\",\n  \"URL\": \"$json:files[0].url$\",\n  \"ThumbnailURL\": \"$json:files[0].url$\"\n}`\n\n  const sharexBlob = new Blob([sharexFile], { type: 'application/octet-binary' })\n  /* eslint-disable-next-line compat/compat */\n  sharexElement.setAttribute('href', URL.createObjectURL(sharexBlob))\n  sharexElement.setAttribute('download', `${originClean}.sxcu`)\n}\n\npage.getPrettyDate = date => {\n  return date.getFullYear() + '-' +\n    (date.getMonth() < 9 ? '0' : '') + // month's index starts from zero\n    (date.getMonth() + 1) + '-' +\n    (date.getDate() < 10 ? '0' : '') +\n    date.getDate() + ' ' +\n    (date.getHours() < 10 ? '0' : '') +\n    date.getHours() + ':' +\n    (date.getMinutes() < 10 ? '0' : '') +\n    date.getMinutes() + ':' +\n    (date.getSeconds() < 10 ? '0' : '') +\n    date.getSeconds()\n}\n\npage.getPrettyBytes = num => {\n  // MIT License\n  // Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (sindresorhus.com)\n  if (typeof num !== 'number' && !isFinite(num)) return num\n\n  const si = localStorage[lsKeys.siBytes] !== '0'\n  const neg = num < 0 ? '-' : ''\n  const scale = si ? 1000 : 1024\n  if (neg) num = -num\n  if (num < scale) return `${neg}${num} B`\n\n  const exponent = Math.min(Math.floor((Math.log(num) * Math.LOG10E) / 3), 8) // 8 is count of KMGTPEZY\n  const numStr = Number((num / Math.pow(scale, exponent)).toPrecision(3))\n  const pre = (si ? 'kMGTPEZY' : 'KMGTPEZY').charAt(exponent - 1) + (si ? '' : 'i')\n  return `${neg}${numStr} ${pre}B`\n}\n"]}